<!DOCTYPE html>
<html>
<head>
<title>Emergency Device Configuration</title>
<style>
body {
    margin: 0;
    font-family: "Segoe UI", sans-serif;
    background: linear-gradient(135deg, #0f172a, #1e293b);
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    color: white;
}

.container {
    background: #111827;
    width: 550px;
    max-height: 85vh;
    padding: 25px 30px;
    border-radius: 14px;
    box-shadow: 0 20px 50px rgba(0,0,0,0.6);
    border: 1px solid #1f2937;
    display: flex;
    flex-direction: column;
}

/* ================= NAV ================= */

.nav {
    display: flex;
    gap: 10px;
    margin-bottom: 15px;
}

.nav button {
    flex: 1;
    padding: 8px;
    border: none;
    border-radius: 8px;
    background: #1e293b;
    color: white;
    cursor: pointer;
}

.nav button:hover {
    background: #2563eb;
}

.nav button.active {
    background: #2563eb;
}

.page {
    display: none;
}

.page.active {
    display: block;
}

/* ================= PAGE 1 STYLES (UNCHANGED) ================= */

h2 {
    margin: 0 0 5px 0;
    font-weight: 500;
}

.subtitle {
    font-size: 13px;
    opacity: 0.6;
    margin-bottom: 15px;
}

.table-wrapper {
    overflow-y: auto;
    max-height: 45vh;
    border: 1px solid #1f2937;
    border-radius: 8px;
}

table {
    width: 100%;
    border-collapse: collapse;
}

th {
    background-color: #2563eb;
    padding: 10px;
    text-align: left;
    font-size: 13px;
}

td {
    padding: 8px;
    border-bottom: 1px solid #1f2937;
}

select, input {
    width: 100%;
    padding: 6px;
    border-radius: 6px;
    border: 1px solid #334155;
    background-color: #1e293b;
    color: white;
    font-size: 13px;
}

.error {
    color: #ef4444;
    font-size: 12px;
    margin-top: 3px;
}

.control-panel {
    margin-top: 15px;
    display: flex;
    gap: 10px;
    align-items: center;
}

.control-panel input {
    width: 70px;
    text-align: center;
}

.control-panel button {
    padding: 6px 12px;
    border: none;
    border-radius: 6px;
    background: #2563eb;
    color: white;
    cursor: pointer;
}

.control-panel button:hover {
    background: #1d4ed8;
}

.save-btn {
    margin-top: 15px;
    padding: 10px;
    background: #2563eb;
    border: none;
    border-radius: 8px;
    font-weight: 500;
    cursor: pointer;
}

.success {
    margin-top: 10px;
    color: #22c55e;
    font-size: 13px;
}

/* Scrollbar styling */
.table-wrapper::-webkit-scrollbar { width: 10px; }
.table-wrapper::-webkit-scrollbar-track { background: #0f172a; }
.table-wrapper::-webkit-scrollbar-thumb {
    background: linear-gradient(180deg, #2563eb, #1d4ed8);
    border-radius: 8px;
}
.table-wrapper { scrollbar-width: thin; scrollbar-color: #2563eb #0f172a; }

/* ================= PAGE 2 STYLES (UNCHANGED) ================= */

.emergency-container {
    text-align: center;
    padding: 40px 10px;
    cursor: pointer;
}

.resting-text {
    font-size: 26px;
    color: #60a5fa;
}

.triggered {
    color: #ef4444;
}

.triggered h1 {
    font-size: 32px;
    font-weight: 800;
}

.triggered .details {
    font-size: 22px;
    margin-top: 12px;
}

.triggered .coordinates {
    font-size: 20px;
    margin-top: 8px;
}

.fade-in {
    animation: fadeIn 0.25s ease-in-out;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(6px); }
    to { opacity: 1; transform: translateY(0); }
}
</style>
</head>

<body>
<div class="container">

    <!-- NAVIGATION -->
    <div class="nav">
        <button class="active" onclick="showPage('page1', this)">Contacts</button>
        <button onclick="showPage('page2', this)">Emergencies</button>
    </div>

    <!-- ================= PAGE 1 ================= -->
    <div id="page1" class="page active">

        <h2>Emergency Response Device</h2>
        <div class="subtitle">CONTACT CONFIGURATION PANEL</div>

        <div class="table-wrapper">
            <table>
                <thead>
                    <tr>
                        <th>#</th>
                        <th>COUNTRY</th>
                        <th>PHONE NUMBER</th>
                    </tr>
                </thead>
                <tbody id="tableBody"></tbody>
            </table>
        </div>

        <div class="control-panel">
            <button onclick="modifyRows(-1)">−</button>
            <input type="number" id="rowAmount" value="1" min="1">
            <button onclick="modifyRows(1)">+</button>
        </div>

        <button class="save-btn" onclick="saveNumbers()">Save Configuration</button>
        <div id="status"></div>

    </div>

    <!-- ================= PAGE 2 (UNCHANGED) ================= -->
    <div id="page2" class="page">
        <div id="emergencyContent" class="emergency-container" onclick="triggerEmergency()">
            <div class="resting-text fade-in">
                There are no emergencies.
            </div>
        </div>
    </div>

</div>

<script>

/* NAVIGATION */
function showPage(pageId, button) {
    document.querySelectorAll(".page").forEach(p => p.classList.remove("active"));
    document.querySelectorAll(".nav button").forEach(b => b.classList.remove("active"));
    document.getElementById(pageId).classList.add("active");
    button.classList.add("active");
}

/* ================= PAGE 1 JS (UNCHANGED) ================= */

let savedNumbers = [];

window.onload = function() {
    const stored = localStorage.getItem("emergencyContacts");
    if (stored) savedNumbers = JSON.parse(stored);
    renderInitialRows();
};

function renderInitialRows() {
    const tableBody = document.getElementById("tableBody");
    tableBody.innerHTML = "";
    if (savedNumbers.length > 0) {
        savedNumbers.forEach(entry => {
            addRow(entry.country, entry.number, false);
        });
    }
    while (tableBody.rows.length < 3) {
        addRow();
    }
}

function addRow(country = "+1", number = "", animate = true) {
    const tableBody = document.getElementById("tableBody");
    const row = tableBody.insertRow();
    if (animate) row.classList.add("fade-in");

    const indexCell = row.insertCell(0);
    const countryCell = row.insertCell(1);
    const phoneCell = row.insertCell(2);

    indexCell.textContent = tableBody.rows.length;

    countryCell.innerHTML = `
        <select>
            <option value="+1" ${country === "+1" ? "selected" : ""}>+1 (US)</option>
            <option value="+44" ${country === "+44" ? "selected" : ""}>+44 (UK)</option>
            <option value="+91" ${country === "+91" ? "selected" : ""}>+91 (IN)</option>
            <option value="+61" ${country === "+61" ? "selected" : ""}>+61 (AU)</option>
        </select>
    `;

    phoneCell.innerHTML = `
        <input type="text" maxlength="12"
               value="${formatForDisplay(number)}"
               placeholder="XXX-XXX-XXXX"
               oninput="formatNumber(this)">
        <div class="error"></div>
    `;
}

function modifyRows(direction) {
    const amount = parseInt(document.getElementById("rowAmount").value) || 1;
    const tableBody = document.getElementById("tableBody");

    if (direction === 1) {
        for (let i = 0; i < amount; i++) addRow();
    }

    if (direction === -1) {
        for (let i = 0; i < amount; i++) {
            if (tableBody.rows.length > 1) tableBody.deleteRow(-1);
        }
    }

    updateRowNumbers();
}

function updateRowNumbers() {
    const rows = document.querySelectorAll("#tableBody tr");
    rows.forEach((row, index) => {
        row.cells[0].textContent = index + 1;
    });
}

function formatNumber(input) {
    const errorDiv = input.nextElementSibling;

    if (/[A-Za-z]/.test(input.value)) {
        errorDiv.textContent = "Invalid Input!";
        return;
    } else {
        errorDiv.textContent = "";
    }

    let digits = input.value.replace(/\D/g, "").substring(0, 10);
    input.value = formatForDisplay(digits);
}

function formatForDisplay(digits) {
    if (!digits) return "";
    if (digits.length > 6)
        return digits.slice(0,3) + "-" + digits.slice(3,6) + "-" + digits.slice(6);
    else if (digits.length > 3)
        return digits.slice(0,3) + "-" + digits.slice(3);
    return digits;
}

function saveNumbers() {
    const rows = document.querySelectorAll("#tableBody tr");
    let newSaved = [];
    let hasError = false;

    rows.forEach(row => {
        const select = row.querySelector("select");
        const input = row.querySelector("input");
        const errorDiv = row.querySelector(".error");

        if (/[A-Za-z]/.test(input.value)) {
            errorDiv.textContent = "Invalid Input!";
            hasError = true;
            return;
        }

        let digits = input.value.replace(/\D/g, "");
        if (digits.length > 0) {
            newSaved.push({ country: select.value, number: digits });
        }
    });

    if (hasError) {
        document.getElementById("status").innerHTML = "";
        return;
    }

    savedNumbers = newSaved;
    localStorage.setItem("emergencyContacts", JSON.stringify(savedNumbers));
    document.getElementById("status").innerHTML =
        "<div class='success'>Configuration Saved Successfully!</div>";
}

/* ================= PAGE 2 JS (UNCHANGED) ================= */

let emergencyTriggered = false;

function triggerEmergency() {
    if (emergencyTriggered) return;
    emergencyTriggered = true;

    const container = document.getElementById("emergencyContent");

    container.innerHTML = `
        <div class="triggered fade-in">
            <h1>THERE IS AN EMERGENCY</h1>
            <div class="details">2450 Palazzo Ct, Buffalo Grove</div>
            <div class="details">60089</div>
            <div class="coordinates">42°11'42.4"N 87°56'53.5"W</div>
            <div class="details"><a href="https://www.google.com/maps/place/2450+Palazzo+Ct,+Buffalo+Grove,+IL+60089/@42.1950941,-87.95015,17z/data=!3m1!4b1!4m6!3m5!1s0x880fbdc162aa18ed:0x24880bd609ca79b3!8m2!3d42.1950911!4d-87.9481999!16s%2Fg%2F11c1ymjgkz?entry=ttu&g_ep=EgoyMDI2MDIxNy4wIKXMDSoASAFQAw%3D%3D" target="_blank" style="color:red; text-decoration:underline;">Directions</a></div>
            <div style="position:absolute; bottom:10px; right:15px; font-size:12px; color:red;">Alert Triggered at 6:35pm</div>
        </div>
    `;
}

</script>
</body>
</html>

